<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Iteration Spaces: Segments and IndexSets &mdash; RAJA 2022.03.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Iteration Space Coloring: Mesh Vertex Sum" href="vertexsum_coloring.html" />
    <link rel="prev" title="Basic Loop Execution: Vector Addition" href="add_vectors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> RAJA
            <img src="../../../_static/RAJA_LOGO_CMYK_White_Background_large.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.03
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">RAJA User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">Getting Started With RAJA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_raja.html">Using RAJA in Your Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config_options.html">Build Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html">RAJA Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../app_considerations.html">Application Considerations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorial.html">RAJA Tutorial and Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../tutorial.html#raja-tutorial">RAJA Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial.html#a-little-c-background">A Little C++ Background</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial.html#raja-examples-and-exercises">RAJA Examples and Exercises</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../tutorial.html#simple-loops-and-basic-raja-features">Simple Loops and Basic RAJA Features</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="add_vectors.html">Basic Loop Execution: Vector Addition</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Iteration Spaces: Segments and IndexSets</a></li>
<li class="toctree-l4"><a class="reference internal" href="vertexsum_coloring.html">Iteration Space Coloring: Mesh Vertex Sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="dot_product.html">Sum Reduction: Vector Dot Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="reductions.html">Reduction Types and Kernels with Multiple Reductions</a></li>
<li class="toctree-l4"><a class="reference internal" href="atomic_histogram.html">Atomic Operations: Computing a Histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="scan.html">Parallel Scan Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="sort.html">Parallel Sort Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="view_layout.html">Data Views and Layouts</a></li>
<li class="toctree-l4"><a class="reference internal" href="permuted-layout-batch-matrix-multiply.html">Permuted Layout: Batched Matrix-Multiplication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial.html#complex-loops-and-advanced-raja-features">Complex Loops and Advanced RAJA Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial.html#nested-loops-with-raja-kernel">Nested Loops with <code class="docutils literal notranslate"><span class="pre">RAJA::kernel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial.html#nested-loops-with-raja-expt-launch">Nested Loops with <code class="docutils literal notranslate"><span class="pre">RAJA::expt::launch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial.html#comparing-raja-kernel-and-raja-expt-launch-matrix-transpose">Comparing <code class="docutils literal notranslate"><span class="pre">RAJA::kernel</span></code> and <code class="docutils literal notranslate"><span class="pre">RAJA::expt::launch</span></code>: Matrix-Transpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial.html#other-raja-features-and-usage-examples">Other RAJA Features and Usage Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev_guide/index.html">RAJA Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../raja_license.html">RAJA Copyright and License Information</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">RAJA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">RAJA User Guide</a> &raquo;</li>
          <li><a href="../tutorial.html">RAJA Tutorial and Examples</a> &raquo;</li>
      <li>Iteration Spaces: Segments and IndexSets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/sphinx/user_guide/tutorial/indexset_segments.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="iteration-spaces-segments-and-indexsets">
<span id="tut-indexset-label"></span><h1>Iteration Spaces: Segments and IndexSets<a class="headerlink" href="#iteration-spaces-segments-and-indexsets" title="Permalink to this headline">¶</a></h1>
<p>This section contains an exercise file <code class="docutils literal notranslate"><span class="pre">RAJA/exercises/segment-indexset-basics.cpp</span></code> for you to work through if you wish to get some practice with RAJA. The
file <code class="docutils literal notranslate"><span class="pre">RAJA/exercises/segment-indexset-basics_solution.cpp</span></code> contains complete
working code for the examples discussed in this section. You can use the
solution file to check your work and for guidance if you get stuck. To build
the exercises execute <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">segment-indexset-basics</span></code> and <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">segment-indexset-basics_solution</span></code>
from the build directory.</p>
<p>Key RAJA features shown in this example are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RAJA::forall</span></code> loop execution template</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeSegment</span></code>, <code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeStrideSegment</span></code>, and
<code class="docutils literal notranslate"><span class="pre">RAJA::TypedListSegment</span></code> iteration space constructs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RAJA::TypedIndexSet</span></code> container and associated execution policies</p></li>
</ul>
</div></blockquote>
<p>The concepts of iteration spaces and associated Loop variables are central to
writing kernels in RAJA. RAJA provides basic iteration space types
that serve as flexible building blocks that can be used to form a variety
of loop iteration patterns. These types can be used to define a particular
order for loop iterates, aggregate and partition iterates, as well as other
configurations.</p>
<p>The examples in this section focus on how to use RAJA index sets and iteration
space segments, such as index ranges and lists of indices. Lists of indices
are important for algorithms that use indirection arrays for irregular array
accesses. Combining different segment types, such as ranges and lists in an
index set allows a user to launch different iteration patterns in a single loop
execution construct (i.e., one kernel). This is something that is not
supported by other programming models and abstractions and is unique to RAJA.
Applying these concepts judiciously can help improve performance by allowing
compilers to optimize for specific segment types (e.g., SIMD for range
segments) while providing the flexibility of indirection arrays for general
indexing patterns.</p>
<p>Although the constructs described in the section are
useful in numerical computations and parallel execution, the examples only
contain print statements and sequential execution. The goal is to show you
how to use RAJA iteration space constructs.</p>
<section id="raja-segments">
<h2>RAJA Segments<a class="headerlink" href="#raja-segments" title="Permalink to this headline">¶</a></h2>
<p>A RAJA <em>Segment</em> represents a set of indices that one wants to execute as a
unit for a kernel. RAJA provides the following Segment types:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeSegment</span></code> represents a stride-1 range</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeStrideSegment</span></code> represents a (non-unit) stride range</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RAJA::TypedListSegment</span></code> represents an arbitrary set of indices</p></li>
</ul>
</div></blockquote>
<p>These segment types are used in <code class="docutils literal notranslate"><span class="pre">RAJA::forall</span></code> and other RAJA kernel
execution mechanisms to define the iteration space for a kernel.</p>
<p>After we briefly introduce these types, we will present several examples using
them.</p>
<section id="typedrangesegment">
<h3>TypedRangeSegment<a class="headerlink" href="#typedrangesegment" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeSegment</span></code> is the fundamental type for defining a
stride-1 (i.e., contiguous) range of indices. This is illustrated in the
figure below.</p>
<figure class="align-default" id="id1">
<img alt="../../../_images/RangeSegment.png" src="../../../_images/RangeSegment.png" />
<figcaption>
<p><span class="caption-text">A range segment defines a stride-1 index range [beg, end).</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>One creates a range segment object as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">A</span> <span class="n">stride</span><span class="o">-</span><span class="mi">1</span> <span class="n">index</span> <span class="nb">range</span> <span class="p">[</span><span class="n">beg</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="n">using</span> <span class="nb">type</span> <span class="nb">int</span><span class="o">.</span>
<span class="n">RAJA</span><span class="p">::</span><span class="n">TypedRangeSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">my_range</span><span class="p">(</span><span class="n">beg</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
</pre></div>
</div>
<p>Any integral type can be given as the template parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using a RAJA range segment, no loop iterations will be run when
begin &gt;= end.</p>
</div>
</section>
<section id="typedrangestridesegment">
<h3>TypedRangeStrideSegment<a class="headerlink" href="#typedrangestridesegment" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeStrideSegment</span></code> defines a range with a constant stride,
including negative stride values if needed. This is illustrated in the
figure below.</p>
<figure class="align-default" id="id2">
<img alt="../../../_images/RangeStrideSegment.png" src="../../../_images/RangeStrideSegment.png" />
<figcaption>
<p><span class="caption-text">A range-stride segment defines an index range with arbitrary stride [beg, end, stride). In the figure the stride is 2.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>One creates a range stride segment object as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">A</span> <span class="n">stride</span><span class="o">-</span><span class="mi">3</span> <span class="n">index</span> <span class="nb">range</span> <span class="p">[</span><span class="n">beg</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="n">using</span> <span class="nb">type</span> <span class="nb">int</span><span class="o">.</span>
<span class="n">RAJA</span><span class="p">::</span><span class="n">TypedRangeStrideSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">my_stride2_range</span><span class="p">(</span><span class="n">beg</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>

<span class="o">//</span> <span class="n">A</span> <span class="n">index</span> <span class="nb">range</span> <span class="k">with</span> <span class="o">-</span><span class="mi">1</span> <span class="n">stride</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">using</span> <span class="nb">type</span> <span class="nb">int</span>
<span class="n">RAJA</span><span class="p">::</span><span class="n">TypedRangeStrideSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">my_neg1_range</span><span class="p">(</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p>Any integral type can be given as the template parameter.</p>
<p>When the negative-stride segment above is passed to a <code class="docutils literal notranslate"><span class="pre">RAJA::forall</span></code> method,
for example, the loop will run in reverse order with iterates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">-</span><span class="mi">1</span>  <span class="n">N</span><span class="o">-</span><span class="mi">2</span>  <span class="n">N</span><span class="o">-</span><span class="mi">3</span> <span class="o">...</span> <span class="mi">1</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using a RAJA strided range, no loop iterations will be run
under the following conditions:</p>
<blockquote>
<div><ul class="simple">
<li><p>Stride &gt; 0 and begin &gt; end</p></li>
<li><p>Stride &lt; 0 and begin &lt; end</p></li>
<li><p>Stride == 0</p></li>
</ul>
</div></blockquote>
</div>
</section>
<section id="typedlistsegment">
<h3>TypedListSegment<a class="headerlink" href="#typedlistsegment" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">RAJA::TypedListSegment</span></code> is used to define an arbitrary set of
indices, akin to an indirection array. This is illustrated in the figure below.</p>
<figure class="align-default" id="id3">
<img alt="../../../_images/ListSegment.png" src="../../../_images/ListSegment.png" />
<figcaption>
<p><span class="caption-text">A list segment defines an arbitrary collection of indices. Here, we have a list segment with 5 irregularly-spaced indices.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>One creates a list segment object by passing a container of integral values to
a list segment constructor. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Create</span> <span class="n">a</span> <span class="n">vector</span> <span class="n">holding</span> <span class="n">some</span> <span class="n">integer</span> <span class="n">index</span> <span class="n">values</span>
<span class="n">std</span><span class="p">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">53</span><span class="p">};</span>

<span class="o">//</span> <span class="n">Create</span> <span class="nb">list</span> <span class="n">segment</span> <span class="k">with</span> <span class="n">these</span> <span class="n">indices</span> <span class="n">where</span> <span class="n">the</span> <span class="n">indices</span> <span class="n">are</span>
<span class="o">//</span> <span class="n">stored</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">CUDA</span> <span class="n">device</span> <span class="n">memory</span> <span class="n">space</span>
<span class="n">camp</span><span class="p">::</span><span class="n">resources</span><span class="p">::</span><span class="n">Resource</span> <span class="n">cuda_res</span><span class="p">{</span><span class="n">camp</span><span class="p">::</span><span class="n">resources</span><span class="p">::</span><span class="n">Cuda</span><span class="p">()};</span>
<span class="n">RAJA</span><span class="p">::</span><span class="n">TypedListSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">idx_list</span><span class="p">(</span> <span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cuda_res</span> <span class="p">);</span>

<span class="o">//</span> <span class="n">Alternatively</span>
<span class="n">RAJA</span><span class="p">::</span><span class="n">TypedListSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="n">idx_list</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span>
                                      <span class="n">cuda_res</span> <span class="p">);</span>
</pre></div>
</div>
<p>When the list segment above is passed to a <code class="docutils literal notranslate"><span class="pre">RAJA::forall</span></code> method,
for example, the kernel will execute with iterates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">53</span>
</pre></div>
</div>
<p>Note that a <code class="docutils literal notranslate"><span class="pre">RAJA::TypedListSegment</span></code> constructor can take a pointer to
an array of indices and an array length. If the indices are
in a container, such as <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> that provides <code class="docutils literal notranslate"><span class="pre">begin()</span></code>, <code class="docutils literal notranslate"><span class="pre">end()</span></code>,
and <code class="docutils literal notranslate"><span class="pre">size()</span></code> methods, the container can be passed to the constructor and
the length argument is not required.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, a camp resource object must be passed to a list segment
constructor to copy the indices in the indices into the proper
memory space for a kernel to execute (as shown above). In the future,
this will change and the user will be responsible for providing
the indices in the proper memory space.</p>
</div>
</section>
</section>
<section id="indexsets">
<h2>IndexSets<a class="headerlink" href="#indexsets" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">RAJA::TypedIndexSet</span></code> is a container that can hold an arbitrary collection
of segment objects. The following figure shows an index set with two contiguous
ranges and an irregularly-spaced list of indices.</p>
<figure class="align-default" id="id4">
<img alt="../../../_images/IndexSet.png" src="../../../_images/IndexSet.png" />
<figcaption>
<p><span class="caption-text">An index set with two range segments and one list segment.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>We can create such an index set as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Create</span> <span class="n">an</span> <span class="n">index</span> <span class="nb">set</span> <span class="n">that</span> <span class="n">can</span> <span class="n">hold</span> <span class="nb">range</span> <span class="ow">and</span> <span class="nb">list</span> <span class="n">segments</span> <span class="k">with</span>
<span class="o">//</span> <span class="nb">int</span> <span class="n">index</span> <span class="n">value</span> <span class="nb">type</span>
<span class="n">RAJA</span><span class="p">::</span><span class="n">TypedIndexSet</span><span class="o">&lt;</span> <span class="n">RAJA</span><span class="p">::</span><span class="n">TypedRangeSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">,</span>
                     <span class="n">RAJA</span><span class="p">::</span><span class="n">TypedListSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">iset</span><span class="p">;</span>

<span class="o">//</span> <span class="n">Add</span> <span class="n">two</span> <span class="nb">range</span> <span class="n">segments</span> <span class="ow">and</span> <span class="n">one</span> <span class="nb">list</span> <span class="n">segment</span> <span class="n">to</span> <span class="n">the</span> <span class="n">index</span> <span class="nb">set</span>
<span class="n">iset</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">RAJA</span><span class="p">::</span><span class="n">TypedRangeSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span> <span class="o">...</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">iset</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">RAJA</span><span class="p">::</span><span class="n">TypedListSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="p">);</span>
<span class="n">iset</span><span class="o">.</span><span class="n">push_back</span><span class="p">(</span> <span class="n">RAJA</span><span class="p">::</span><span class="n">TypedRangeSegment</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span> <span class="o">...</span> <span class="p">)</span> <span class="p">);</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">RAJA::TypedIndexSet</span></code> object can be passed to a RAJA kernel execution
method, such as <code class="docutils literal notranslate"><span class="pre">RAJA::forall</span></code> to execute all segments in the index set
with one method call. We will show this in detail in the examples below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is the responsibility of the user to ensure that segments are
defined properly when using RAJA index sets. For example, if the
same index appears in multiple segments, the corresponding loop
iteration will be run multiple times.</p>
</div>
</section>
<section id="segment-and-indexset-examples">
<h2>Segment and IndexSet Examples<a class="headerlink" href="#segment-and-indexset-examples" title="Permalink to this headline">¶</a></h2>
<p>The examples in this section illustrate how the  segment types that RAJA
provides can be used to define kernel iteration spaces. We use the following
type aliases to make the code more compact:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="n">IdxType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">int</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">RangeSegType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RAJA</span><span class="o">::</span><span class="n">TypedRangeSegment</span><span class="o">&lt;</span><span class="n">IdxType</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">RangeStrideSegType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RAJA</span><span class="o">::</span><span class="n">TypedRangeStrideSegment</span><span class="o">&lt;</span><span class="n">IdxType</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">ListSegType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RAJA</span><span class="o">::</span><span class="n">TypedListSegment</span><span class="o">&lt;</span><span class="n">IdxType</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
<span class="k">using</span><span class="w"> </span><span class="n">IndexSetType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RAJA</span><span class="o">::</span><span class="n">TypedIndexSet</span><span class="o">&lt;</span><span class="w"> </span><span class="n">RangeSegType</span><span class="p">,</span><span class="w"> </span><span class="n">ListSegType</span><span class="w"> </span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<section id="stride-1-indexing">
<h3>Stride-1 Indexing<a class="headerlink" href="#stride-1-indexing" title="Permalink to this headline">¶</a></h3>
<p>Consider a simple C-style kernel that prints a contiguous sequence of values:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>When run, the kernel prints the following sequence, as expected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span> <span class="mi">15</span> <span class="mi">16</span> <span class="mi">17</span> <span class="mi">18</span> <span class="mi">19</span>
</pre></div>
</div>
<p>Three RAJA variants of the kernel using a <code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeSegment</span></code>, a
<code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeStrideSegment</span></code>, and a <code class="docutils literal notranslate"><span class="pre">RAJA::TypedListSegment</span></code> are:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">RAJA</span><span class="o">::</span><span class="n">forall</span><span class="o">&lt;</span><span class="n">RAJA</span><span class="o">::</span><span class="n">seq_exec</span><span class="o">&gt;</span><span class="p">(</span><span class="n">RangeSegType</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="o">=</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">RAJA</span><span class="o">::</span><span class="n">forall</span><span class="o">&lt;</span><span class="n">RAJA</span><span class="o">::</span><span class="n">seq_exec</span><span class="o">&gt;</span><span class="p">(</span><span class="n">RangeStrideSegType</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="o">=</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">//</span>
<span class="w">  </span><span class="c1">// Collect indices in a vector to create list segment</span>
<span class="w">  </span><span class="c1">//</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">IdxType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">idx</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">idx</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span>

<span class="w">  </span><span class="n">ListSegType</span><span class="w"> </span><span class="n">idx_list1</span><span class="p">(</span><span class="w"> </span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="n">host_res</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="n">RAJA</span><span class="o">::</span><span class="n">forall</span><span class="o">&lt;</span><span class="n">RAJA</span><span class="o">::</span><span class="n">seq_exec</span><span class="o">&gt;</span><span class="p">(</span><span class="n">idx_list1</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">=</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<p>Each of these variants prints the same integer sequence shown above.</p>
<p>One interesting thing to note is that with <code class="docutils literal notranslate"><span class="pre">RAJA::TypedListSegment</span></code> and
<code class="docutils literal notranslate"><span class="pre">RAJA::forall</span></code>, the actual iteration value is passed to the lambda loop body.
So the indirection array concept is not visible. In contrast, in C-style code,
one has to manually retrieve the index value from the indirection array to
achieve the desired result. For example:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">IdxType</span><span class="w"> </span><span class="n">iis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">IdxType</span><span class="o">&gt;</span><span class="p">(</span><span class="n">idx</span><span class="p">.</span><span class="n">size</span><span class="p">());</span><span class="w">  </span><span class="c1">// to avoid compiler warning</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">iis</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">idx</span><span class="p">[</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="non-unit-stride-indexing">
<h3>Non-unit Stride Indexing<a class="headerlink" href="#non-unit-stride-indexing" title="Permalink to this headline">¶</a></h3>
<p>Consider the following C-style kernel that prints the integer sequence
discussed earlier in reverse order:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">19</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>We can accomplish the same result using a <code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeStrideSegment</span></code>:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">RAJA</span><span class="o">::</span><span class="n">forall</span><span class="o">&lt;</span><span class="n">RAJA</span><span class="o">::</span><span class="n">seq_exec</span><span class="o">&gt;</span><span class="p">(</span><span class="n">RangeStrideSegType</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="o">=</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<p>Alternatively, we can use a <code class="docutils literal notranslate"><span class="pre">RAJA::TypedListSegment</span></code>, where we reverse the
index array we used earlier to define the appropriate list segment:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">//</span>
<span class="w">  </span><span class="c1">// Reverse the order of indices in the vector</span>
<span class="w">  </span><span class="c1">//</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">reverse</span><span class="p">(</span><span class="w"> </span><span class="n">idx</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="w"> </span><span class="n">idx</span><span class="p">.</span><span class="n">end</span><span class="p">()</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">ListSegType</span><span class="w"> </span><span class="nf">idx_list1_reverse</span><span class="p">(</span><span class="w"> </span><span class="o">&amp;</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">idx</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">host_res</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="n">RAJA</span><span class="o">::</span><span class="n">forall</span><span class="o">&lt;</span><span class="n">RAJA</span><span class="o">::</span><span class="n">seq_exec</span><span class="o">&gt;</span><span class="p">(</span><span class="n">idx_list1_reverse</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">=</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<p>The more common use of the <code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeStrideSegment</span></code> type is to run
constant strided loops with a positive non-unit stride. For example:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">RAJA</span><span class="o">::</span><span class="n">forall</span><span class="o">&lt;</span><span class="n">RAJA</span><span class="o">::</span><span class="n">seq_exec</span><span class="o">&gt;</span><span class="p">(</span><span class="n">RangeStrideSegType</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="o">=</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<p>The C-style equivalent of this is:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="indexsets-complex-iteration-spaces">
<h3>IndexSets: Complex Iteration Spaces<a class="headerlink" href="#indexsets-complex-iteration-spaces" title="Permalink to this headline">¶</a></h3>
<p>We noted earlier that <code class="docutils literal notranslate"><span class="pre">RAJA::TypedIndexSet</span></code> objects can be used to partition
iteration spaces into disjoint parts. Among other things, this can be useful to
expose parallelism in algorithms that would otherwise require significant
code transformation to do so. Please see <a class="reference internal" href="vertexsum_coloring.html#tut-vertexsum-label"><span class="std std-ref">Iteration Space Coloring: Mesh Vertex Sum</span></a> for
discussion of an example that illustrates this.</p>
<p>Here is an example that uses two <code class="docutils literal notranslate"><span class="pre">RAJA::TypedRangeSegment</span></code> objects in an
index set to represent an iteration space broken into two disjoint
contiguous intervals:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">SEQ_ISET_EXECPOL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RAJA</span><span class="o">::</span><span class="n">ExecPolicy</span><span class="o">&lt;</span><span class="n">RAJA</span><span class="o">::</span><span class="n">seq_segit</span><span class="p">,</span><span class="w"></span>
<span class="w">                                            </span><span class="n">RAJA</span><span class="o">::</span><span class="n">seq_exec</span><span class="o">&gt;</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="n">IndexSetType</span><span class="w"> </span><span class="n">is2</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">is2</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">RangeSegType</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">is2</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">RangeSegType</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">  </span>
<span class="w">  </span><span class="n">RAJA</span><span class="o">::</span><span class="n">forall</span><span class="o">&lt;</span><span class="n">SEQ_ISET_EXECPOL</span><span class="o">&gt;</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">=</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<p>The integer sequence that is printed is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">9</span>  <span class="mi">15</span>  <span class="mi">16</span>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">19</span>
</pre></div>
</div>
<p>as we expect.</p>
<p>The execution policy type when using a RAJA index set is a
<em>two-level</em> policy. The first level specifies how to iterate over the segments
in the index set, such as sequentially or in parallel using OpenMP. The second
level is the execution policy used to execute each segment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Iterating over the indices of all segments in a RAJA index set
requires a two-level execution policy, with two template parameters,
as shown above. The first parameter specifies how to iterate over
the segments. The second parameter specifies how the kernel will
execute each segment over each segment.
See <a class="reference internal" href="../feature/policies.html#indexsetpolicy-label"><span class="std std-ref">RAJA IndexSet Execution Policies</span></a> for more information about
RAJA index set execution policies.</p>
</div>
<p>It is worth noting that a C-style version of this kernel requires either
an indirection array to run in one loop or two for-loops. For example:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Finally, we show an example that uses an index set holding two range segments
and one list segment to partition an iteration space into three parts:</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">IndexSetType</span><span class="w"> </span><span class="n">is3</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="n">is3</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">RangeSegType</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="n">IdxType</span><span class="w"> </span><span class="n">indx</span><span class="p">[</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">22</span><span class="p">};</span><span class="w"></span>
<span class="w">  </span><span class="n">ListSegType</span><span class="w"> </span><span class="nf">list2</span><span class="p">(</span><span class="w"> </span><span class="n">indx</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">host_res</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">is3</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">list2</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="n">is3</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="w"> </span><span class="n">RangeSegType</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="p">);</span><span class="w"></span>
<span class="w"> </span>
<span class="w">  </span><span class="n">RAJA</span><span class="o">::</span><span class="n">forall</span><span class="o">&lt;</span><span class="n">SEQ_ISET_EXECPOL</span><span class="o">&gt;</span><span class="p">(</span><span class="n">is3</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">=</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">IdxType</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">});</span><span class="w"></span>
</pre></div>
</div>
<p>The integer sequence that is printed is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">14</span>  <span class="mi">20</span>  <span class="mi">22</span>  <span class="mi">24</span>  <span class="mi">25</span>  <span class="mi">26</span>  <span class="mi">27</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="add_vectors.html" class="btn btn-neutral float-left" title="Basic Loop Execution: Vector Addition" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vertexsum_coloring.html" class="btn btn-neutral float-right" title="Iteration Space Coloring: Mesh Vertex Sum" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Lawrence Livermore National Security, LLNS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>